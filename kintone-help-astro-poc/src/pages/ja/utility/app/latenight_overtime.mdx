---
title: "深夜残業時間を計算したい"
weight: 3000
disabled: "[US,CN]"
aliases:
  - "/ja/id/040797"
layout: "@/layouts/PageLayout.astro"
---

import Heading from "@/components/Heading.astro";
import Hint from "@/components/Hint.astro";
import Img from "@/components/Img.astro";
import Kintone from "@/components/Kintone.astro";
import Reference from "@/components/Reference.astro";


<Kintone />では、勤怠を入力するアプリで計算式を使って、勤務日ごとに深夜残業時間（22時から翌日5時まで）が何時間あるかを算出できます。  

<Heading id="app_latenight_overtime_10">設定例</Heading>

ここでは、1レコードに1か月分の勤怠を入力するアプリを例に説明します。

<Heading level={3} id="app_latenight_overtime_1010">準備</Heading>

勤怠を入力するアプリを準備してください。  
1レコードに1か月分の勤怠を入力するアプリを作成するには、テーブルに勤務日ごとに入力してほしいフィールドを配置します。

深夜残業時間を算出するために、以下の3つのフィールドを含めてください。

* (1) 時刻フィールド：出勤時刻を入力するフィールド  
* (2) 時刻フィールド：退勤時刻を入力するフィールド  
* (3) 計算フィールド：深夜残業時間を算出するフィールド  

<Img src="/k/kintone/img-ja/latenight_overtime_01.png" alt="フィールドの配置例" />  

<Heading level={3} id="app_latenight_overtime_1020">各フィールドの設定</Heading>

* <b>(1) 時刻フィールド</b>  
  このフィールドは、出勤時刻を入力するために使用します。  
  * フィールド名：出勤  
  * フィールドコード：出勤  
<br />

* <b>(2) 時刻フィールド</b>  
  このフィールドは、退勤時刻を入力するために使用します。  
  * フィールド名：退勤  
  * フィールドコード：退勤  
<br />

* <b>(3) 計算フィールド</b>  
  このフィールドでは、(1)(2)で入力された勤務時間のうち、深夜残業時間が何時間あるかを算出します。  
  * フィールド名：深夜残業時間  
  * フィールドコード：深夜残業時間
  * 計算式：以下の計算式を設定します。  
    参考：[計算式の解説](#app_latenight_overtime_20)  

  ```
  IF(出勤=退勤,7*60*60,
    IF(AND(出勤&lt;=5*60*60, 出勤&lt;=退勤, 退勤&lt;=5*60*60),退勤-出勤,
      IF(AND(出勤&lt;=5*60*60, 退勤&gt;=5*60*60, 退勤&lt;=22*60*60),5*60*60-出勤,
        IF(AND(出勤&lt;=5*60*60, 退勤&gt;=22*60*60),(5*60*60-出勤)+(退勤-22*60*60),
          IF(AND(出勤&lt;=5*60*60, 退勤&lt;=出勤),(5*60*60-出勤)+(2*60*60)+退勤,
            IF(AND(出勤&lt;=22*60*60, 退勤&gt;=22*60*60),退勤-22*60*60,
              IF(AND(出勤&lt;=22*60*60, 退勤&lt;=5*60*60),2*60*60+退勤,
                IF(AND(出勤&lt;=22*60*60, 退勤&gt;=5*60*60, 退勤&lt;出勤),7*60*60,
                  IF(AND(出勤&gt;=22*60*60, 退勤&gt;=出勤),退勤-出勤,
                    IF(AND(出勤&gt;=22*60*60, 退勤&lt;=出勤, 退勤&gt;=22*60*60),(24*60*60-出勤)+5*60*60+(退勤-22*60*60),
                      IF(AND(出勤&gt;=22*60*60, 退勤&lt;=5*60*60),(24*60*60-出勤)+退勤,
                        IF(AND(出勤&gt;=22*60*60, 退勤&gt;=5*60*60, 退勤&lt;=22*60*60),(24*60*60-出勤)+5*60*60,0
                        )
                      )
                    )
                  )
                )
              )
            )
          )
        )
      )
    )
  )

  ```

  <br />  

  * 表示形式：「時間（例：26時間3分）」を選択

<Heading level={3} id="app_latenight_overtime_20">計算式の解説</Heading>

この計算式では、IF関数を使用して、出勤時刻と退勤時刻の入力パターンごとに条件分岐するように記述しています。  
これにより、様々な出勤時刻や退勤時刻を入力しても、勤務日ごとに深夜残業時間を算出できます。  

<Hint>
<Kintone />では、日付、時刻、日時のフィールドの値はUNIX時刻として扱われます。このため、日付や日時は秒単位で扱い、計算式も秒単位で指定します。たとえば、1分間を「60」、1時間を「3600」または「1\*60\*60」と入力します。  

</Hint>

<b>この計算式で記載されている条件分岐</b>

(1) 出勤時刻と退勤時刻が同じ場合（24時間勤務）  

* 条件式：出勤=退勤
* 計算式：7\*60\*60

<br />

(2) 出勤時刻：0時～5時、退勤時刻：出勤時刻以降～5時の場合  

* 条件式：AND(出勤&lt;=5\*60\*60, 出勤&lt;=退勤, 退勤&lt;=5\*60\*60)
* 計算式：退勤-出勤

<br />

(3) 出勤時刻：0時～5時、退勤時刻：5時～22時の場合  

* 条件式：AND(出勤&lt;=5\*60\*60, 退勤&gt;=5\*60\*60, 退勤&lt;=22\*60\*60)
* 計算式：5\*60\*60-出勤

<br />

(4) 出勤時刻：0時～5時、退勤時刻：22時～翌日0時の場合  

* 条件式：AND(出勤&lt;=5\*60\*60, 退勤&gt;=22\*60\*60)
* 計算式：(5\*60\*60-出勤)+(退勤-22\*60\*60)

<br />

(5) 出勤時刻：0時～5時、退勤時刻：翌日の0時～出勤時刻以前の場合  

* 条件式：AND(出勤&lt;=5\*60\*60, 退勤&lt;=出勤)
* 計算式：(5\*60\*60-出勤)+(2\*60\*60)+退勤

<br />

(6) 出勤時刻：5時～22時、退勤時刻：22時～翌日0時の場合  

* 条件式：AND(出勤&lt;=22\*60\*60, 退勤&gt;=22\*60\*60)
* 計算式：退勤-22\*60\*60

<br />

(7) 出勤時刻：5時～22時、退勤時刻：翌日の0時～5時の場合  

* 条件式：AND(出勤&lt;=22\*60\*60, 退勤&lt;=5\*60\*60)
* 計算式：2\*60\*60+退勤

<br />

(8) 出勤時刻：5時～22時、退勤時刻：翌日の5時～出勤時刻以前の場合

* 条件式：AND(出勤&lt;=22\*60\*60, 退勤&gt;=5\*60\*60, 退勤&lt;出勤)
* 計算式：7\*60\*60

<br />

(9) 出勤時刻：22時～0時、退勤時刻：出勤時刻以降の22時～0時の場合

* 条件式：AND(出勤&gt;=22\*60\*60, 退勤&gt;=出勤)
* 計算式：退勤-出勤

<br />

(10) 出勤時刻：22時～0時、退勤時刻：翌日の22時～0時かつ出勤時刻以前の場合  

* 条件式：AND(出勤&gt;=22\*60\*60, 退勤&lt;=出勤, 退勤&gt;=22\*60\*60)
* 計算式：(24\*60\*60-出勤)+5\*60\*60+(退勤-22\*60\*60)

<br />

(11) 出勤時刻：22時～0時、退勤時刻：翌日の0時～5時の場合  

* 条件式：AND(出勤&gt;=22\*60\*60, 退勤&lt;=5\*60\*60)
* 計算式：(24\*60\*60-出勤)+退勤

<br />

(12) 出勤時刻：22時～0時、退勤時刻：翌日の5時～22時の場合  

* 条件式：AND(出勤&gt;=22\*60\*60, 退勤&gt;=5\*60\*60, 退勤&lt;=22\*60\*60)
* 計算式：(24\*60\*60-出勤)+5\*60\*60

<Reference>

* [[IF関数]条件によって表示する値を変える](/k/ja/id/040505.html)  
* [[AND、OR、NOT関数]条件の組み合わせ](/k/ja/id/040496.html)  
* [日付、時刻、日時の計算](/k/ja/id/040502.html)  

</Reference>

<Heading id="app_latenight_overtime_30">アプリテンプレート</Heading>

この計算式が設定されたアプリのテンプレートを、以下よりダウンロードできます。  

<table>
    <thead>
        <tr>
            <th style="text-align: center;">アプリテンプレート「latenight_overtime.zip」（日本語のみ）</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
              <div style="text-align: center;">
                <a href="/k/files-ja/latenight_overtime.zip"><img src="/k/img/icon_add_tmpl_file.png" alt="" /><br />
                </a>
              </div>
              <div style="text-align: center;">
                <a href="/k/files-ja/latenight_overtime.zip">latenight_overtime.zip</a>
              </div>
            </td>
        </tr>
    </tbody>
</table>

リンクをクリックしてテンプレートファイル（zip）をダウンロードしたあと、解凍せずに<Kintone />で読み込んでください。

<Reference>

[テンプレートファイルからアプリを作成する](/k/ja/id/040627.html)  

</Reference>
