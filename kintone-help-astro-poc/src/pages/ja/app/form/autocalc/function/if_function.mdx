---
title: "[IF関数]条件によって表示する値を変える"
weight: 100
aliases:
  - "/ja/id/040505"
layout: "@/layouts/PageLayout.astro"
---

import Heading from "@/components/Heading.astro";
import Note from "@/components/Note.astro";
import Reference from "@/components/Reference.astro";


IF関数は、設定した条件式の結果に応じて、返す値を変更します。

<Heading id="autocalc_if_function_10">IF関数の構文</Heading>
```plaintext {copy=true}
IF(条件式, 真の場合に返す値, 偽の場合に返す値)

```

IF関数には、引数として「条件式」、「真の場合に返す値」、「偽の場合に返す値」を指定します。  
IF関数は、複数の関数や計算式を階層構造（入れ子）で記載できます。長い計算式は、改行やインデントを使って見やすく表示できます。

<Heading level={3} id="autocalc_if_function_1010">条件式で使用できる演算子</Heading>
「条件式」の引数には、フィールドコードや値と、比較演算子を組み合わせた条件式を指定できます。  
条件式では以下の演算子が利用できます。

* =
* !=
* &lt;&gt;
* &lt;
* &lt;=
* \>
* \>=

数値型のフィールド（数値フィールドなど）を比較する場合は、上記の演算子がすべて利用できます。  
文字列型のフィールド（文字列（1行）フィールドなど）を比較する場合は、「＝」「!=」「&lt;&gt;」のみが利用できます。文字列型では、「等しいかどうか」の比較だけが可能です。

フィールドのデータ型については、「[フィールドのデータ型](/k/ja/id/040500.html#autocalc_calculation_type_10)」を参照してください。

<Reference>

[演算子と関数の一覧](/k/ja/id/040499.html)

</Reference>

<Heading level={3} id="autocalc_if_function_1020">返す値の書き方</Heading>
「真の場合に返す値」および「偽の場合に返す値」には、数値型、文字列型、論理型の結果を返す計算式または値を指定します。  
文字列を直接指定する場合はダブルクォーテーション（"）で囲みます。

```plaintext {copy=true}
IF(宿泊="あり", "出張申請が必要です", "出張申請は不要です")

```

計算結果に文字列を表示する場合、計算式は文字列（1行）フィールドに設定します。

<Heading level={4} id="autocalc_if_function_102010">返す値を空欄にする場合</Heading>
返す値を空欄にする場合、「""」と記入します。

次の例は、「個数」フィールドが0の場合に、空欄を表示する計算式です。「個数」フィールドが0ではない場合は、「個数」フィールドと「単価」フィールドを乗算した結果を表示します。

```plaintext {copy=true}
IF(個数=0, "", 単価*個数)

```

<Heading level={3} id="autocalc_if_function_1040">計算対象のフィールドが未入力かどうかを条件に指定する場合</Heading>
計算対象のフィールドが未入力かどうかを条件に指定する場合、計算式に空文字列（""）を指定します。  
たとえば、「数値フィールド=""」と指定すると、数値フィールドが未入力のときは真、「0」が入力されているときは偽となります。

次の例は、「個数」フィールドが未入力の場合に、「未入力」と表示する計算式です。「個数」フィールドが入力されている場合は、「個数」フィールドと「単価」フィールドを乗算した結果を表示します。

```plaintext {copy=true}
IF(個数="", "未入力", 単価*個数)

```

計算結果に文字列を表示する場合、計算式は文字列（1行）フィールドに設定します。

<Note>

条件式に「数値フィールド=0」と指定すると、数値フィールドに「0」が入力されているときだけではなく、数値フィールドが未入力のときも真になります。  
これは、数値型フィールドが未入力の場合に「0」とみなされて計算されるためです。

</Note>

<Heading level={3} id="autocalc_if_function_1060">ほかの関数との組み合わせ</Heading>
IF関数は、CONTAINS関数やAND、OR、NOT関数を組み合わせることで、より詳細な条件式を設定できます。  
詳しくは、各関数のページを参照してください。

<Reference>

* [[CONTAINS関数]フィールドの中に、指定した文字列と完全一致するものがあるか判定する](/k/ja/id/040506.html)
* [[AND、OR、NOT関数]条件の組み合わせ](/k/ja/id/040496.html)
* [[SUM関数、CONTAINS関数]テーブルの計算](/k/ja/id/040510.html)

</Reference>

<Heading level={3} id="autocalc_if_function_1030">計算対象のフィールドが未入力の場合の計算結果</Heading>
数値型フィールドが参照されていて未入力の場合は、「0」とみなされて計算されます。
文字型フィールドが参照されていて未入力の場合は、空文字列（""）とみなされて計算されます。

<Heading id="autocalc_if_function_20">計算式の例</Heading>
計算式でフィールドを指定する場合は、引数としてフィールド名ではなくフィールドコードを指定してください。  
次の例では、フィールド名とフィールドコードをすべて一致させています。

<Heading level={3} id="autocalc_if_function_2010">合計が80点以上の場合に「OK」を表示する計算式</Heading>
次の例は、「合計」フィールドが80点以上の場合には「OK」を表示、80点未満の場合は「NG」を表示する計算式です。

```plaintext {copy=true}
IF(合計>=80,"OK","NG")

```

計算式は、文字列（1行）フィールドに設定します。文字列（1行）フィールドを配置し、「自動計算する」にチェックを付けて計算式を入力します。

<Heading level={3} id="autocalc_if_function_2020">合計金額が指定した金額以上の場合に15%引きの価格を表示する計算式</Heading>
次の例は、「合計金額」フィールドが1,000円以上であれば15%引きの価格を表示、1,000円未満であればそのままの合計金額を表示する計算式です。

```plaintext {copy=true}
IF(合計金額>=1000, 合計金額*0.85, 合計金額)

```

<Heading level={3} id="autocalc_if_function_2030">チェック状況に応じて異なる料金を表示する計算式</Heading>
次の例は、「朝食」フィールドで「あり」が選択されていたら宿泊費9,000円、「なし」が選択されていたら宿泊費7,000円を表示する計算式です。

```plaintext {copy=true}
IF(朝食="あり", 9000, 7000)

```

「朝食」フィールドはドロップダウンフィールドまたはラジオボタンフィールドにします。  
ドロップダウンまたはラジオボタンを条件に指定する場合は、項目名をダブルクォーテーション（"）で囲んで指定します。

<Reference>

[CONTAINS関数を使う例](/k/ja/id/040506.html#autocalc_multichoice_contains_2040)

</Reference>

<Heading level={3} id="autocalc_if_function_2060">「0」が入力された場合と1以上の数値が入力された場合で計算を変える計算式</Heading>
次の例は、「予算」フィールドと「実績」フィールドをもとに、予算比を計算する計算式です。  
「予算」フィールドが「0」であればフィールドを空欄にし、「0」より大きい数であれば「予算比」を計算します。

```plaintext {copy=true}
IF(予算>0, (実績/予算)*100, "")

```

予算比を出す割り算「実績/予算」だけを計算式に書くと、予算が「0」のときに分母が「0」になりエラーとなります。そのため、この計算式ではIF関数を使用して、予算が「0」の時には計算しないように場合分けしています。

<Heading level={3} id="autocalc_if_function_2040">目標値を達成しているかどうかを判定する計算式</Heading>
次の例は、「合計」フィールドが「目標値」フィールド以上であれば「達成」を表示、「合計」フィールドが「目標値」フィールドを下回っている場合は「未達」を表示する計算式です。

```plaintext {copy=true}
IF(合計>=目標値,"達成","未達")

```

計算式は、文字列（1行）フィールドに設定します。文字列（1行）フィールドを配置し、「自動計算する」にチェックを付けて計算式を入力します。

<Heading level={3} id="autocalc_if_function_2050">採点結果を表示する計算式</Heading>
次の例は、試験の点数が100点であれば満点、80点以上であれば合格、そうでなければ不合格と表示する計算式です。

```plaintext {copy=true}
IF(点数=100,"満点",IF(点数>=80,"合格","不合格"))

```

計算式は、文字列（1行）フィールドに設定します。文字列（1行）フィールドを配置し、「自動計算する」にチェックを付けて計算式を入力します。

<Reference>

[計算式で表示されるエラー](/k/ja/id/040497.html)

</Reference>
