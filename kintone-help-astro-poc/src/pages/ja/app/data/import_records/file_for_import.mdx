---
title: "レコード登録・上書き用のファイルを準備する"
weight: 400
aliases:
  - "/ja/id/040771"
layout: "@/layouts/PageLayout.astro"
---

import Heading from "@/components/Heading.astro";
import Img from "@/components/Img.astro";
import Note from "@/components/Note.astro";


ここでは、ファイルからレコードのデータを登録・上書きするには、どのようなファイルを準備したらよいかを説明します。

* ファイルがすでにある場合は、このページを参考にして、ファイルが読み込みに適しているかどうかを確認してください。
* ファイルがまだない場合は、まずアプリからレコードのデータをファイルに書き出し、そのファイルを元に編集することをおすすめします。このページを参考にして、書き出したファイルを完成させてください。  
  [ファイルにデータを書き出す](/k/ja/id/040452.html)

<Heading id="import_records_file_for_import_10">ファイル形式</Heading>
アプリに読み込みできるファイル形式（拡張子）は、以下のとおりです。

* Excel形式（xlsx）／CSV形式（csv）／TXT形式（txt）／TSV形式（tsv）

Excel形式（xlsx）のファイルは、Microsoft Excel（以降、Excel）で作成できます。  
シートが複数ある場合は、1シート目のデータが読み込まれます。また、非表示のセルや結合されているセルのデータも読み込まれます。あらかじめ、セルを再表示・結合解除し、ファイルの記載に問題がないかを確認してください。

CSV形式（csv）／TXT形式（txt）／TSV形式（tsv）のファイルは、表計算ソフト（例：ExcelやOpen Office Calc）やテキストエディターなどで作成できます。

<Note>
**「日本語・英数字」以外の文字を入力する場合**  
日本語版のExcelでファイルを作成すると、文字コードに「Shift-JIS」が使用されるため、日本語・英数字以外の文字が文字化けする場合があります。この場合は、Open Office Calcなどの、Excel以外のソフトウェアを使用し、ファイルを保存する際に文字コードを「UTF-8」に指定してください。

</Note>

<Heading id="import_records_file_for_import_20">ファイルのサイズと行数・列数の上限値</Heading>
* Excel形式（xlsx）の場合  
  最大1MB、1,000行まで
* CSV形式（csv）／TXT形式（txt）／TSV形式（tsv）の場合  
  最大100MB、10万行まで

ファイル形式にかかわらず、読み込み先のフィールドに対応付けできるのは、ファイルの1,000列目までです。

読み込むファイルのサイズや行数・列数が上限値を超える場合は、ファイルを分割するか、Excel形式であれば、ファイル形式を変更してください。  
アプリに登録できるレコード数やフィールド数の上限値などは、「[制限値一覧](/k/ja/id/04044.html)」を参照してください。

<Heading id="import_records_file_for_import_30">1レコードごとのファイルの記載形式</Heading>
ファイルには、1レコードごとに、読み込みに適した形式で記載してください。

<Img src="/k/kintone/img-ja/file_for_import_01.png" alt="スクリーンショット：1レコードごとのファイルの記載形式" />

1レコードごとの記載形式には、以下の3つのポイントがあります。

* ポイント1：ファイルの先頭行には、項目名を記載します。  
  項目名として読み込み先のフィールド名を記載しておくと、ファイルを読み込んだ際に、そのフィールドにファイルの列を自動的に対応付けます。
* ポイント2：各項目の値は、2行目以降に記載します。  
  対応付けするフィールドごとに読み込み可能な形式で記載します。各フィールドの記載形式は、「[フィールドごとの記載形式](#import_records_file_for_import_40)」を参照してください。
* ポイント3：1レコードのデータは、1行で記載します。  
  ただし、レコードにテーブルが含まれる場合は、1レコードのデータは、テーブルの行数にあわせて1行～複数行で記載します。テーブルを含むレコードの記載形式は、「[テーブルを含むレコードを登録・上書きするためのファイルを準備する](/k/ja/id/040725.html)」を参照してください。

<Heading id="import_records_file_for_import_40">フィールドごとのファイルの記載形式</Heading>
ファイルには、フィールドごとに読み込みに適した形式で値を記載してください。  
フィールドごとの記載形式の詳細は、「[レコード登録・上書き用のファイルの記載形式](/k/ja/id/040722.html)」を参照してください。

また、フィールドによっては、入力できる値や文字数に制限がある場合があります。  
詳細は、「[フィールドの入力制限](/k/ja/id/040528.html)」を参照してください。

値を記載せずに読み込むと、読み込み先のフィールドの値は、空または初期値（初期値が設定されている場合）で登録・上書きされます。

<Note>

* 以下のフィールドは、ファイルを読み込んだ後に再計算・再取得されます。そのため、ファイルに値を記載する必要はありません。
  * 文字列（1行）フィールド（自動計算を設定している場合）
  * 計算フィールド
  * ルックアップの設定で「ほかのフィールドのコピー」に指定されているフィールド


</Note>

<Heading id="import_records_file_for_import_50">参考：Excelでのファイル作成・編集の基本操作</Heading>
ここでは、Excelでファイルを開いて保存するまでの基本操作を紹介します。  
お使いのExcelのバージョンによっては、メニュー名や操作が異なる場合があります。

<Heading level={3} id="import_records_file_for_import_5010">最初からファイルを作成する</Heading>
1. Excelを開いて、1シート目にレコードのデータを記載します。

1. [ファイル]タブをクリックし、[名前を付けて保存]をクリックします。

1. 保存場所やファイル名を指定します。

1. ファイルの種類を「Excelブック」または「CSV（カンマ区切り）」に指定します。

1. [保存]をクリックします。

<Heading level={3} id="import_records_file_for_import_5020">書き出したファイルを編集する</Heading>
レコードのデータを書き出したCSVファイルを元に編集します。  
参考：[ファイルにデータを書き出す](/k/ja/id/040452.html)

1. レコード一覧画面を開きます。

1. ファイルに書き出したいレコードが表示されているかを確認します。  
  ファイルに書き出したいレコードが表示されていない場合や、レコードを絞り込む場合は、絞り込みの条件を変更してください。

1. レコード一覧画面右上の「オプション」アイコンをクリックし、[ファイルに書き出す]をクリックします。
  <Note>
  [ファイルに書き出す]が表示されない場合は、アプリのアクセス権の設定で「ファイル書き出し」権限を付与してください。  
  [アプリにアクセス権を設定する](/k/ja/id/040589.html)
    </Note>

1. 書き出したいフィールドを指定して、[書き出す]ボタンをクリックします。

1. 出力されたCSVファイルをダウンロードします。

1. ダウンロードしたCSVファイルをExcelで開いて、編集します。  
   レコードを新しく登録したい場合は、行を追加して、登録するデータを記載します。
   <Note>
   書き出したレコードにテーブルが含まれる場合、ファイルには1レコードのデータが複数行で出力されます。  
   テーブルを含むレコードのデータを編集する方法は、「[テーブルを含むレコードを登録・上書きするためのファイルを準備する](/k/ja/id/040725.html)」を参照してください。
      </Note>

1. [ファイル]タブをクリックし、[上書き保存]をクリックします。
