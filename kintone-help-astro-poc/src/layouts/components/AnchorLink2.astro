---
import Wovn from '@/components/Wovn.astro';

interface TocItem {
  Level: number;
  Anchor: string;
  Text: string;
  Attributes?: {
    class?: string;
    [key: string]: any;
  };
}

interface Props {
  ti: TocItem;
  ids?: boolean;
  al?: string;
}

const { ti, ids, al } = Astro.props;

// 安全なHTMLを作成するための関数
const safeHTML = (html: string) => html;
---

{ti.Level === 2 && (
  <div class="section-delimiter"></div>
)}
<div class="id-header" id={ti.Anchor}>
  <Fragment set:html={`<h${ti.Level} class="h${ti.Level}-contents ${ti.Attributes?.class || ''}" pid="${ti.Anchor}">${safeHTML(ti.Text)}</h${ti.Level}>`} />
  {ids && (
    <button 
      class="id-link-button" 
      title="i18n__todo__Copy_perma_link" 
      data-idpath={al} 
      tabindex="0" 
      aria-owns={`message-${ti.Anchor}`}
    >
      <i class="fas fa-link" aria-hidden="true"></i>
    </button>
  )}
</div>
<div id={`message-${ti.Anchor}`} class="id-link-message"><Wovn>i18n__Link_was_copied</Wovn></div>