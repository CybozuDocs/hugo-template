---
import Wovn from '@/components/Wovn.astro';
import type { BaseProps } from './types';

interface Props extends BaseProps {}

const { env, page } = Astro.props;

// エイリアスから最初の要素を取得
const alias = page.params.aliases?.[0] || '';

// エイリアスをスラッシュで分割
const a1 = alias.split('/');

// 最後の要素をドキュメントIDとして取得
const docid = a1[a1.length - 1] || '';

// 相対パスの処理
let relpath = page.relPermalink.replace(/\.html$/, '');
relpath = relpath.replace(new RegExp(page.fileContentBaseName + '$'), '');

// ドキュメントURLの生成
const docurl = `${env.baseURL}${relpath}id/${docid}.html`;
---

<div class="idbar">
  <div class="idstr">Document ID:{docid}</div>
  <div class="id-link">
    <button 
      class="heading-button" 
      tabindex="0" 
      aria-owns="doc-id" 
      aria-expanded="false"
    >
      <span><Wovn>i18n__Permalink</Wovn></span>
      <i class="fas fa-link" aria-hidden="true"></i>
    </button>
    <div id="doc-id" class="heading-url" aria-hidden="true">
      <input 
        readonly 
        value="" 
        name="headingUrl" 
        idpath={alias} 
        type="text" 
        onclick="this.focus(); this.select()"
      />
    </div>
  </div>
</div>