---
import { getSiteHome } from "@/lib/page";
import Title from './Title.astro';
import type { PageProps } from './types';

interface Props {
  p1: PageProps;
  p2: PageProps;
}

const { p1, p2 } = Astro.props;

// 再帰的にパンくずリストを構築
const breadcrumbItems: PageProps[] = [];

function buildBreadcrumb(current: PageProps) {
  if (current.parent) {
    buildBreadcrumb(current.parent);
  } else if (!current.isHome && getSiteHome()) {
    buildBreadcrumb(getSiteHome());
  }
  breadcrumbItems.push(current);
}

buildBreadcrumb(p1);
---

{breadcrumbItems.map((item) => (
  <li>
    {item === p2 ? (
      <Title page={item} />
    ) : (
      <a href={item.relPermalink}>
        <Title page={item} />
      </a>
    )}
  </li>
))}